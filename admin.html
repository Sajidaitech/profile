<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Admin Panel — Sajid Mehmood</title>
<link rel="icon" href="logo.png" type="image/png">
<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,400;0,600;0,700;0,900;1,400&family=Montserrat:wght@300;400;500;600;700&family=DM+Mono:wght@400;500&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<style>
/* ── PORTFOLIO DESIGN TOKENS ── */
:root {
  --offwhite:    #F8F9FA;
  --paper:       #FFFFFF;
  --graphite:    #2D3436;
  --graphite-md: #4A5568;
  --graphite-lt: #718096;
  --graphite-xl: #A0AEC0;
  --gold:        #C5A059;
  --gold-lt:     #E8C97A;
  --gold-dk:     #A07840;
  --border:      #E2E8EF;
  --shadow-sm:   0 2px 12px rgba(45,52,54,.07);
  --shadow-md:   0 8px 30px rgba(45,52,54,.10);
  --shadow-lg:   0 16px 48px rgba(45,52,54,.13);
  --glass-bg:    rgba(255,255,255,.80);
  --transition:  0.3s cubic-bezier(0.4,0,0.2,1);
  --nav-h:       68px;
  --red: #e74c3c; --green: #27ae60;
}
*, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
html { scroll-behavior: smooth; font-size: 16px; }
body { font-family: 'Montserrat', sans-serif; background: var(--offwhite); color: var(--graphite); line-height: 1.7; overflow-x: hidden; }
a { color: inherit; text-decoration: none; }
img { display: block; max-width: 100%; }

/* ── GRAIN ── */
.grain-overlay {
  position: fixed; inset: 0; z-index: 0; pointer-events: none;
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='300' height='300'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='300' height='300' filter='url(%23n)' opacity='0.03'/%3E%3C/svg%3E");
  opacity: .5;
}

/* ══════════════════════════════════════
   LOGIN SCREEN
══════════════════════════════════════ */
#loginScreen {
  display: flex; align-items: center; justify-content: center;
  min-height: 100vh; position: relative; z-index: 10;
  background: linear-gradient(160deg, rgba(197,160,89,.06) 0%, transparent 50%), var(--offwhite);
}
.login-wrap { width: 100%; max-width: 440px; padding: 24px; }

.login-eyebrow {
  display: flex; align-items: center; gap: 12px;
  font-family: 'DM Mono', monospace; font-size: 10px;
  color: var(--graphite-lt); letter-spacing: 2px; text-transform: uppercase;
  margin-bottom: 18px; justify-content: center;
}
.login-rule { width: 28px; height: 1px; background: var(--gold); }

.login-card {
  background: var(--paper); border: 1px solid var(--border);
  border-radius: 10px; overflow: hidden;
  box-shadow: var(--shadow-lg), 0 0 0 1px rgba(197,160,89,.06);
}
.login-card-top {
  background: linear-gradient(135deg, var(--graphite), #4A5568);
  padding: 30px 36px 26px; position: relative; text-align: center;
}
.login-card-top::before {
  content: ''; position: absolute; top: 0; left: 0; right: 0; height: 3px;
  background: linear-gradient(90deg, var(--gold), var(--gold-lt));
}
.login-icon {
  width: 56px; height: 56px; border-radius: 50%;
  background: linear-gradient(135deg, var(--gold), var(--gold-lt));
  display: flex; align-items: center; justify-content: center;
  font-size: 22px; color: var(--graphite);
  margin: 0 auto 16px;
  box-shadow: 0 8px 24px rgba(197,160,89,.35);
}
.login-card-top h1 {
  font-family: 'Playfair Display', serif; font-size: 22px; font-weight: 900;
  color: #fff; margin-bottom: 5px;
}
.login-card-top p {
  font-family: 'DM Mono', monospace; font-size: 10px;
  color: rgba(255,255,255,.45); letter-spacing: 1.5px;
}

.login-card-body { padding: 30px 36px 36px; }
.login-field { margin-bottom: 18px; }
.login-field label {
  display: flex; align-items: center; gap: 7px;
  font-size: 11px; font-weight: 700; color: var(--graphite-md);
  text-transform: uppercase; letter-spacing: .7px; margin-bottom: 7px;
}
.login-field label i { color: var(--gold); font-size: 10px; }
.login-field input {
  width: 100%; padding: 13px 16px;
  background: var(--offwhite); border: 1.5px solid var(--border);
  border-radius: 6px; font-family: 'Montserrat', sans-serif;
  font-size: 14px; color: var(--graphite); outline: none;
  transition: all var(--transition);
}
.login-field input:focus {
  border-color: var(--gold); background: var(--paper);
  box-shadow: 0 0 0 3px rgba(197,160,89,.10);
}
.login-submit {
  width: 100%; padding: 14px 26px;
  background: linear-gradient(135deg, var(--gold), var(--gold-lt));
  color: var(--graphite); border: none; border-radius: 4px;
  font-family: 'Montserrat', sans-serif; font-size: 13px; font-weight: 700;
  letter-spacing: .6px; text-transform: uppercase; cursor: pointer;
  display: flex; align-items: center; justify-content: center; gap: 8px;
  transition: all var(--transition); box-shadow: 0 4px 16px rgba(197,160,89,.25);
  margin-top: 22px;
}
.login-submit:hover {
  background: linear-gradient(135deg, var(--gold-dk), var(--gold));
  box-shadow: 0 6px 24px rgba(197,160,89,.4); transform: translateY(-1px);
}
.login-err {
  margin-top: 14px; font-family: 'DM Mono', monospace; font-size: 12px;
  color: var(--red); min-height: 18px; text-align: center;
}
.login-back {
  display: inline-flex; align-items: center; gap: 7px;
  font-size: 12px; color: var(--graphite-lt); margin-top: 20px;
  font-family: 'DM Mono', monospace; letter-spacing: .5px;
  transition: color var(--transition);
}
.login-back:hover { color: var(--gold); }

/* ══════════════════════════════════════
   ADMIN NAVBAR
══════════════════════════════════════ */
#adminApp { display: none; min-height: 100vh; }

.admin-nav {
  position: fixed; top: 0; left: 0; right: 0; z-index: 800;
  height: var(--nav-h);
  background: rgba(248,249,250,.92);
  backdrop-filter: blur(20px) saturate(200%);
  -webkit-backdrop-filter: blur(20px) saturate(200%);
  border-bottom: 1px solid var(--border);
  box-shadow: var(--shadow-sm);
}
.admin-nav-inner {
  max-width: 100%; padding: 0 32px; height: 100%;
  display: flex; align-items: center; justify-content: space-between; gap: 16px;
}
.admin-nav-brand {
  display: flex; align-items: center; gap: 12px;
}
.admin-nav-brand img { width: 36px; height: 36px; object-fit: contain; flex-shrink: 0; }
.brand-text { display: flex; flex-direction: column; }
.brand-name {
  font-family: 'Playfair Display', serif; font-size: 14px; font-weight: 700;
  color: var(--graphite); line-height: 1.2;
}
.brand-sub {
  font-family: 'DM Mono', monospace; font-size: 9px; color: var(--gold);
  letter-spacing: 1.5px; text-transform: uppercase;
}
.admin-nav-actions { display: flex; align-items: center; gap: 8px; }

.sidebar-burger {
  display: none; background: none; border: 1.5px solid var(--border);
  border-radius: 4px; padding: 8px 10px; cursor: pointer;
  color: var(--graphite-md); font-size: 14px; transition: all var(--transition);
}
.sidebar-burger:hover { border-color: var(--gold); color: var(--gold); }

.nav-btn-preview {
  display: inline-flex; align-items: center; gap: 7px;
  padding: 8px 18px; border-radius: 4px; font-size: 12px;
  font-family: 'Montserrat', sans-serif; font-weight: 700;
  letter-spacing: .5px; text-transform: uppercase; cursor: pointer;
  background: var(--graphite); color: var(--paper); border: none;
  transition: all var(--transition);
}
.nav-btn-preview:hover { background: var(--gold); color: var(--graphite); transform: translateY(-1px); }

.nav-btn-logout {
  display: inline-flex; align-items: center; gap: 7px;
  padding: 8px 18px; border-radius: 4px; font-size: 12px;
  font-family: 'Montserrat', sans-serif; font-weight: 700;
  letter-spacing: .5px; text-transform: uppercase; cursor: pointer;
  background: transparent; color: var(--graphite-lt);
  border: 1.5px solid var(--border); transition: all var(--transition);
}
.nav-btn-logout:hover { border-color: var(--red); color: var(--red); }

/* ══════════════════════════════════════
   LAYOUT: SIDEBAR + MAIN
══════════════════════════════════════ */
.admin-body {
  display: flex; padding-top: var(--nav-h); min-height: 100vh;
}

/* ── SIDEBAR ── */
.admin-sidebar {
  width: 244px; flex-shrink: 0;
  background: var(--paper); border-right: 1px solid var(--border);
  position: fixed; top: var(--nav-h); left: 0; bottom: 0;
  overflow-y: auto; z-index: 100;
  box-shadow: var(--shadow-sm);
  transition: transform var(--transition);
}
.sb-section-label {
  padding: 18px 22px 6px;
  font-family: 'DM Mono', monospace; font-size: 9px;
  color: var(--graphite-xl); letter-spacing: 2px; text-transform: uppercase;
}
.sb-link {
  display: flex; align-items: center; gap: 12px;
  padding: 11px 22px; font-size: 13px; font-weight: 600;
  color: var(--graphite-lt); cursor: pointer;
  border-left: 3px solid transparent;
  transition: all var(--transition);
  font-family: 'Montserrat', sans-serif;
}
.sb-link:hover { color: var(--graphite); background: var(--offwhite); }
.sb-link.active {
  color: var(--gold-dk); border-left-color: var(--gold);
  background: rgba(197,160,89,.06);
}
.sb-link i {
  width: 16px; text-align: center; font-size: 13px; color: var(--gold); flex-shrink: 0;
}
.sb-link.active i { color: var(--gold-dk); }

/* ── MAIN CONTENT ── */
.admin-main {
  flex: 1; margin-left: 244px;
  padding: 40px 44px; max-width: 100%;
  transition: margin-left var(--transition);
}

/* ── PANELS ── */
.tab-panel { display: none; max-width: 860px; margin: 0 auto; }
.tab-panel.active { display: block; animation: paneIn .25s ease; }
@keyframes paneIn { from{opacity:0;transform:translateY(6px)} to{opacity:1;transform:none} }

.panel-eyebrow {
  display: flex; align-items: center; gap: 12px;
  font-family: 'DM Mono', monospace; font-size: 10px;
  color: var(--graphite-lt); letter-spacing: 2px; text-transform: uppercase;
  margin-bottom: 10px;
}
.panel-eyebrow-rule { width: 24px; height: 1px; background: var(--gold); flex-shrink: 0; }
.panel-heading {
  font-family: 'Playfair Display', serif; font-size: 30px; font-weight: 900;
  color: var(--graphite); letter-spacing: -.5px; margin-bottom: 4px;
}
.panel-sub {
  font-size: 14px; color: var(--graphite-lt); margin-bottom: 32px; line-height: 1.7;
}

/* ── SECTION CARDS ── */
.a-card {
  background: var(--paper); border: 1px solid var(--border);
  border-radius: 8px; overflow: hidden;
  box-shadow: var(--shadow-sm); margin-bottom: 20px;
  transition: box-shadow var(--transition);
}
.a-card:hover { box-shadow: var(--shadow-md); }
.a-card-head {
  background: linear-gradient(135deg, rgba(197,160,89,.07), rgba(197,160,89,.02));
  border-bottom: 1px solid rgba(197,160,89,.14);
  padding: 16px 24px; display: flex; align-items: center; gap: 10px;
}
.a-card-icon {
  width: 32px; height: 32px; border-radius: 6px; flex-shrink: 0;
  background: linear-gradient(135deg, var(--gold), var(--gold-lt));
  display: flex; align-items: center; justify-content: center;
  color: var(--graphite); font-size: 12px;
}
.a-card-title {
  font-family: 'Playfair Display', serif; font-size: 15px; font-weight: 700;
  color: var(--graphite);
}
.a-card-body { padding: 24px; }

/* ── FORM ELEMENTS ── */
.f-row { display: grid; grid-template-columns: 1fr 1fr; gap: 16px; }
.f-group { display: flex; flex-direction: column; gap: 7px; margin-bottom: 16px; }
.f-group:last-child { margin-bottom: 0; }
.f-group.f-full { grid-column: 1 / -1; }
.f-group label {
  font-size: 11px; font-weight: 700; color: var(--graphite-md);
  text-transform: uppercase; letter-spacing: .6px;
  display: flex; align-items: center; gap: 6px;
  font-family: 'Montserrat', sans-serif;
}
.f-group label i { color: var(--gold); font-size: 10px; }
.f-group input,
.f-group textarea,
.f-group select {
  padding: 12px 16px;
  background: var(--offwhite); border: 1.5px solid var(--border);
  border-radius: 6px; font-family: 'Montserrat', sans-serif;
  font-size: 14px; color: var(--graphite); outline: none;
  transition: all var(--transition); resize: vertical;
}
.f-group input:focus,
.f-group textarea:focus,
.f-group select:focus {
  border-color: var(--gold); background: var(--paper);
  box-shadow: 0 0 0 3px rgba(197,160,89,.10);
}
.f-hint {
  font-family: 'DM Mono', monospace; font-size: 11px;
  color: var(--graphite-xl);
}

/* ── BUTTONS ── */
.btn-save {
  display: inline-flex; align-items: center; gap: 8px;
  padding: 12px 26px; border-radius: 4px; font-size: 13px;
  font-family: 'Montserrat', sans-serif; font-weight: 700;
  letter-spacing: .6px; text-transform: uppercase; cursor: pointer; border: none;
  background: linear-gradient(135deg, var(--gold), var(--gold-lt));
  color: var(--graphite); box-shadow: 0 4px 16px rgba(197,160,89,.25);
  transition: all var(--transition); margin-top: 4px;
}
.btn-save:hover {
  background: linear-gradient(135deg, var(--gold-dk), var(--gold));
  box-shadow: 0 6px 24px rgba(197,160,89,.4); transform: translateY(-2px);
}
.btn-add {
  display: inline-flex; align-items: center; gap: 8px;
  padding: 9px 18px; border-radius: 4px; font-size: 12px;
  font-family: 'Montserrat', sans-serif; font-weight: 700;
  letter-spacing: .5px; text-transform: uppercase; cursor: pointer;
  background: transparent; color: var(--graphite-md);
  border: 1.5px solid var(--border); transition: all var(--transition);
  margin-bottom: 14px;
}
.btn-add:hover { border-color: var(--gold); color: var(--gold-dk); background: rgba(197,160,89,.04); }
.btn-add i { color: var(--gold); }

.btn-remove {
  display: inline-flex; align-items: center; gap: 6px;
  padding: 6px 12px; border-radius: 4px; font-size: 11px;
  font-family: 'Montserrat', sans-serif; font-weight: 700;
  letter-spacing: .4px; text-transform: uppercase; cursor: pointer;
  background: transparent; color: var(--graphite-xl);
  border: 1.5px solid var(--border); transition: all var(--transition);
}
.btn-remove:hover { border-color: var(--red); color: var(--red); }

.btn-download {
  display: inline-flex; align-items: center; gap: 8px;
  padding: 13px 28px; border-radius: 4px; font-size: 13px;
  font-family: 'Montserrat', sans-serif; font-weight: 700;
  letter-spacing: .6px; text-transform: uppercase; cursor: pointer;
  background: var(--graphite); color: var(--paper); border: none;
  box-shadow: var(--shadow-sm); transition: all var(--transition); margin-top: 8px;
}
.btn-download:hover { background: var(--gold); color: var(--graphite); transform: translateY(-2px); }

.btn-github {
  display: inline-flex; align-items: center; gap: 8px;
  padding: 13px 28px; border-radius: 4px; font-size: 13px;
  font-family: 'Montserrat', sans-serif; font-weight: 700;
  letter-spacing: .6px; text-transform: uppercase; cursor: pointer;
  background: transparent; color: var(--graphite);
  border: 1.5px solid var(--graphite); transition: all var(--transition); margin-top: 8px;
}
.btn-github:hover { background: var(--graphite); color: var(--paper); transform: translateY(-2px); }

/* ── REPEAT ITEMS ── */
.repeat-item {
  background: var(--offwhite); border: 1px solid var(--border);
  border-radius: 8px; padding: 20px; margin-bottom: 14px;
  transition: border-color var(--transition);
}
.repeat-item:hover { border-color: rgba(197,160,89,.28); }
.repeat-item-head {
  display: flex; align-items: center; justify-content: space-between;
  margin-bottom: 16px;
}
.repeat-item-num {
  font-family: 'DM Mono', monospace; font-size: 10px;
  color: var(--gold); letter-spacing: 1px;
}

/* ── SKILL RANGE ── */
.range-row { display: flex; align-items: center; gap: 14px; }
.range-row input[type=range] { flex: 1; accent-color: var(--gold); height: 4px; }
.range-num {
  font-family: 'Playfair Display', serif; font-size: 20px; font-weight: 900;
  color: var(--gold); min-width: 44px; text-align: right; line-height: 1;
}

/* ── TOAST ── */
#saveToast {
  position: fixed; bottom: 28px; right: 28px;
  background: var(--graphite); color: var(--gold);
  padding: 14px 24px; border-radius: 6px;
  font-family: 'DM Mono', monospace; font-size: 12px; font-weight: 600;
  letter-spacing: .5px; display: none; z-index: 9999;
  box-shadow: var(--shadow-lg); border-left: 3px solid var(--gold);
  align-items: center; gap: 8px;
  animation: toastIn .3s ease;
}
@keyframes toastIn { from{transform:translateY(12px);opacity:0} to{transform:none;opacity:1} }

/* ── DASHBOARD ── */
.dash-grid {
  display: grid; grid-template-columns: repeat(auto-fit, minmax(160px,1fr));
  gap: 16px; margin-bottom: 28px;
}
.dash-stat {
  background: var(--paper); border: 1px solid var(--border);
  border-radius: 8px; padding: 24px 20px; text-align: center;
  box-shadow: var(--shadow-sm); transition: all var(--transition);
  position: relative; overflow: hidden;
}
.dash-stat::after {
  content: ''; position: absolute; bottom: 0; left: 0; right: 0; height: 2px;
  background: linear-gradient(90deg, var(--gold), var(--gold-lt));
  transform: scaleX(0); transform-origin: left; transition: transform var(--transition);
}
.dash-stat:hover { box-shadow: var(--shadow-md); }
.dash-stat:hover::after { transform: scaleX(1); }
.ds-num {
  font-family: 'Playfair Display', serif; font-size: 36px; font-weight: 900;
  color: var(--graphite); line-height: 1;
}
.ds-lbl {
  font-family: 'DM Mono', monospace; font-size: 10px;
  color: var(--graphite-lt); margin-top: 7px; letter-spacing: .5px; text-transform: uppercase;
}

/* ── CODE BLOCK ── */
code {
  font-family: 'DM Mono', monospace; font-size: 12px; color: var(--gold-dk);
  background: rgba(197,160,89,.1); border: 1px solid rgba(197,160,89,.2);
  padding: 2px 7px; border-radius: 3px;
}

/* ── PUBLISH STEPS ── */
.pub-steps { list-style: none; counter-reset: st; }
.pub-steps li {
  counter-increment: st; display: flex; gap: 14px;
  margin-bottom: 18px; align-items: flex-start;
}
.pub-steps li::before {
  content: counter(st); flex-shrink: 0;
  width: 26px; height: 26px; border-radius: 50%;
  background: linear-gradient(135deg, var(--gold), var(--gold-lt));
  color: var(--graphite); font-family: 'Playfair Display', serif;
  font-size: 12px; font-weight: 900;
  display: flex; align-items: center; justify-content: center;
  margin-top: 3px;
}
.pub-steps li p { font-size: 14px; line-height: 1.8; color: var(--graphite-md); }
.pub-steps li strong { color: var(--graphite); }

/* ── GITHUB TOKEN BANNER ── */
.github-banner {
  background: rgba(197,160,89,.07); border: 1px solid rgba(197,160,89,.25);
  border-radius: 8px; padding: 20px 24px; margin-bottom: 20px;
  display: flex; gap: 14px; align-items: flex-start;
}
.github-banner i { color: var(--gold); font-size: 18px; margin-top: 2px; flex-shrink: 0; }
.github-banner-text { flex: 1; }
.github-banner-text strong {
  display: block; font-size: 13px; font-weight: 700; color: var(--graphite); margin-bottom: 5px;
}
.github-banner-text p { font-size: 13px; color: var(--graphite-lt); line-height: 1.7; }

/* ── ONE-TAP PUSH BUTTON ── */
.push-big-btn {
  display: inline-flex; align-items: center; gap: 12px;
  padding: 18px 48px; border-radius: 6px; font-size: 16px;
  font-family: 'Playfair Display', serif; font-weight: 700;
  letter-spacing: .3px; cursor: pointer; border: none;
  background: linear-gradient(135deg, var(--graphite), #4A5568);
  color: var(--paper);
  box-shadow: var(--shadow-md), 0 0 0 3px rgba(197,160,89,.15);
  transition: all var(--transition);
}
.push-big-btn:hover {
  background: linear-gradient(135deg, var(--gold), var(--gold-lt));
  color: var(--graphite);
  box-shadow: var(--shadow-lg), 0 0 0 3px rgba(197,160,89,.3);
  transform: translateY(-3px);
}
.push-big-btn i { font-size: 20px; }

/* ── TOKEN STEPS ── */
.token-steps { display: flex; flex-direction: column; gap: 0; }
.token-step {
  display: flex; gap: 16px; align-items: flex-start;
  padding-bottom: 24px; padding-left: 4px;
  border-left: 2px solid var(--border);
  margin-left: 12px; padding-left: 24px; position: relative;
}
.token-step:last-child { border-left-color: transparent; padding-bottom: 0; }
.token-step-num {
  position: absolute; left: -13px; top: 0;
  width: 26px; height: 26px; border-radius: 50%;
  background: linear-gradient(135deg, var(--gold), var(--gold-lt));
  color: var(--graphite); font-family: 'Playfair Display', serif;
  font-size: 12px; font-weight: 900;
  display: flex; align-items: center; justify-content: center;
  flex-shrink: 0; box-shadow: 0 2px 8px rgba(197,160,89,.3);
}
.token-step-body { flex: 1; padding-top: 2px; }
.token-step-body strong {
  display: block; font-size: 14px; font-weight: 700;
  color: var(--graphite); margin-bottom: 6px;
  font-family: 'Playfair Display', serif;
}
.token-step-body p { font-size: 13px; color: var(--graphite-md); line-height: 1.8; }

/* Token input with eye toggle */
.token-input-wrap {
  position: relative; margin-top: 10px;
}
.token-input-wrap input {
  width: 100%; padding: 13px 48px 13px 16px;
  background: var(--offwhite); border: 1.5px solid var(--border);
  border-radius: 6px; font-family: 'DM Mono', monospace;
  font-size: 13px; color: var(--graphite); outline: none;
  transition: all var(--transition);
}
.token-input-wrap input:focus {
  border-color: var(--gold); background: var(--paper);
  box-shadow: 0 0 0 3px rgba(197,160,89,.10);
}
.token-toggle-btn {
  position: absolute; right: 14px; top: 50%; transform: translateY(-50%);
  background: none; border: none; cursor: pointer;
  color: var(--graphite-xl); font-size: 14px; padding: 4px;
  transition: color var(--transition);
}
.token-toggle-btn:hover { color: var(--gold); }
</style>
@media(max-width:768px) {
  .admin-sidebar {
    transform: translateX(-100%);
    box-shadow: none;
  }
  .admin-sidebar.open {
    transform: translateX(0);
    box-shadow: var(--shadow-lg);
  }
  .sidebar-burger { display: flex; }
  .admin-main { margin-left: 0; padding: 24px 18px; }
  .f-row { grid-template-columns: 1fr; }
  .admin-nav-inner { padding: 0 18px; }
  .nav-btn-preview span, .nav-btn-logout span { display: none; }
}
@media(max-width:480px) {
  .dash-grid { grid-template-columns: 1fr 1fr; }
  .panel-heading { font-size: 24px; }
}
</style>
</head>
<body>
<div class="grain-overlay" aria-hidden="true"></div>

<!-- ════════════════════════════════════
     LOGIN SCREEN
════════════════════════════════════ -->
<div id="loginScreen">
  <div class="login-wrap">
    <div class="login-eyebrow">
      <span class="login-rule"></span>
      Secure Access
      <span class="login-rule"></span>
    </div>
    <div class="login-card">
      <div class="login-card-top">
        <div class="login-icon"><i class="fas fa-shield-alt"></i></div>
        <h1>Portfolio Admin</h1>
        <p>Sajid Mehmood · sajidmk.com</p>
      </div>
      <div class="login-card-body">
        <div class="login-field">
          <label><i class="fas fa-user"></i> Username</label>
          <input type="text" id="loginUser" placeholder="Enter username" autocomplete="username">
        </div>
        <div class="login-field">
          <label><i class="fas fa-lock"></i> Password</label>
          <input type="password" id="loginPass" placeholder="sajid2020" autocomplete="current-password"
                 onkeydown="if(event.key==='Enter') doLogin()">
        </div>
        <button class="login-submit" onclick="doLogin()">
          <i class="fas fa-sign-in-alt"></i> Sign In
        </button>
        <div class="login-err" id="loginErr"></div>
      </div>
    </div>
    <a href="index.html" class="login-back">
      <i class="fas fa-arrow-left"></i> Back to Portfolio
    </a>
  </div>
</div>

<!-- ════════════════════════════════════
     ADMIN APP
════════════════════════════════════ -->
<div id="adminApp">

  <!-- NAV -->
  <nav class="admin-nav">
    <div class="admin-nav-inner">
      <div class="admin-nav-brand">
        <button class="sidebar-burger" onclick="toggleSidebar()"><i class="fas fa-bars"></i></button>
        <img src="logo.png" alt="SM">
        <div class="brand-text">
          <span class="brand-name">Sajid Mehmood</span>
          <span class="brand-sub">Admin Panel</span>
        </div>
      </div>
      <div class="admin-nav-actions">
        <button class="nav-btn-preview" onclick="window.open('index.html','_blank')">
          <i class="fas fa-eye"></i> <span>Preview</span>
        </button>
        <button class="nav-btn-logout" onclick="logout()">
          <i class="fas fa-sign-out-alt"></i> <span>Logout</span>
        </button>
      </div>
    </div>
  </nav>

  <div class="admin-body">

    <!-- SIDEBAR -->
    <aside class="admin-sidebar" id="adminSidebar">
      <div class="sb-section-label">Overview</div>
      <div class="sb-link active" onclick="showTab('dashboard',this)">
        <i class="fas fa-tachometer-alt"></i> Dashboard
      </div>

      <div class="sb-section-label">Content</div>
      <div class="sb-link" onclick="showTab('hero',this)">
        <i class="fas fa-home"></i> Hero Section
      </div>
      <div class="sb-link" onclick="showTab('about',this)">
        <i class="fas fa-user"></i> About Me
      </div>
      <div class="sb-link" onclick="showTab('education',this)">
        <i class="fas fa-graduation-cap"></i> Education
      </div>
      <div class="sb-link" onclick="showTab('experience',this)">
        <i class="fas fa-briefcase"></i> Experience
      </div>
      <div class="sb-link" onclick="showTab('skills',this)">
        <i class="fas fa-tools"></i> Skills
      </div>
      <div class="sb-link" onclick="showTab('certifications',this)">
        <i class="fas fa-certificate"></i> Certifications
      </div>
      <div class="sb-link" onclick="showTab('contact',this)">
        <i class="fas fa-envelope"></i> Contact Info
      </div>

      <div class="sb-section-label">Settings</div>
      <div class="sb-link" onclick="showTab('password',this)">
        <i class="fas fa-key"></i> Change Password
      </div>
      <div class="sb-link" onclick="showTab('publish',this)">
        <i class="fas fa-upload"></i> Publish Changes
      </div>
    </aside>

    <!-- MAIN -->
    <main class="admin-main">

      <!-- DASHBOARD -->
      <div class="tab-panel active" id="tab-dashboard">
        <div class="panel-eyebrow"><span class="panel-eyebrow-rule"></span> Overview</div>
        <h1 class="panel-heading">Dashboard</h1>
        <p class="panel-sub">Welcome back, Sajid. Your portfolio at a glance.</p>
        <div class="dash-grid" id="dashStats"></div>

        <!-- QUICK PUSH STRIP -->
        <div class="a-card" style="margin-bottom:20px">
          <div class="a-card-head" style="background:linear-gradient(135deg,rgba(45,52,54,.06),rgba(45,52,54,.02));border-bottom-color:rgba(45,52,54,.1)">
            <div class="a-card-icon" style="background:linear-gradient(135deg,var(--graphite),#4A5568)"><i class="fab fa-github"></i></div>
            <span class="a-card-title">Quick Publish</span>
          </div>
          <div class="a-card-body" style="display:flex;align-items:center;justify-content:space-between;flex-wrap:wrap;gap:16px">
            <div>
              <p style="font-size:13px;color:var(--graphite-md);line-height:1.7">
                After saving your edits, push directly to <strong>github.com/Sajidaitech/profile</strong>.
              </p>
              <p id="dashLastPush" style="font-family:'DM Mono',monospace;font-size:11px;color:var(--graphite-xl);margin-top:4px"></p>
            </div>
            <button class="btn-save" id="dashPushBtn" onclick="dashPush()" style="white-space:nowrap;flex-shrink:0">
              <i class="fab fa-github"></i> Push Live
            </button>
          </div>
          <div id="dashPushStatus" style="padding:0 24px 16px;font-family:'DM Mono',monospace;font-size:12px;min-height:14px"></div>
        </div>

        <div class="a-card">
          <div class="a-card-head">
            <div class="a-card-icon"><i class="fas fa-info-circle"></i></div>
            <span class="a-card-title">Quick Guide</span>
          </div>
          <div class="a-card-body">
            <p style="font-size:14px;line-height:1.9;color:var(--graphite-md)">
              Use the <strong style="color:var(--graphite)">left sidebar</strong> to navigate between sections.
              Edit any field and click <strong style="color:var(--gold-dk)">Save Changes</strong> — your edits persist in the browser.
              When ready, hit <strong style="color:var(--graphite)">Push Live</strong> above to deploy instantly.
            </p>
          </div>
        </div>
      </div>

      <!-- HERO -->
      <div class="tab-panel" id="tab-hero">
        <div class="panel-eyebrow"><span class="panel-eyebrow-rule"></span> Section 00</div>
        <h1 class="panel-heading">Hero Section</h1>
        <p class="panel-sub">Edit your headline, ID card details, KPIs, and resume link.</p>

        <div class="a-card">
          <div class="a-card-head"><div class="a-card-icon"><i class="fas fa-id-card"></i></div><span class="a-card-title">ID Card Info</span></div>
          <div class="a-card-body">
            <div class="f-row">
              <div class="f-group"><label>Full Name</label><input id="h-name" placeholder="Sajid Mehmood"></div>
              <div class="f-group"><label>Job Title</label><input id="h-title" placeholder="IT Support Engineer"></div>
            </div>
            <div class="f-row">
              <div class="f-group"><label>Location</label><input id="h-location" placeholder="Doha, Qatar"></div>
              <div class="f-group"><label>Availability Badge</label><input id="h-avail" placeholder="Available for Opportunities"></div>
            </div>
          </div>
        </div>

        <div class="a-card">
          <div class="a-card-head"><div class="a-card-icon"><i class="fas fa-heading"></i></div><span class="a-card-title">Headline & Brief</span></div>
          <div class="a-card-body">
            <div class="f-group"><label>Headline Line 1</label><input id="h-line1" placeholder="From Hospitals to Airports —"></div>
            <div class="f-group"><label>Headline Line 2 (italic gold)</label><input id="h-line2" placeholder="I Keep IT"></div>
            <div class="f-group"><label>Headline Line 3</label><input id="h-line3" placeholder="Running."></div>
            <div class="f-group"><label>Brief Paragraph</label><textarea id="h-brief" rows="4"></textarea></div>
          </div>
        </div>

        <div class="a-card">
          <div class="a-card-head"><div class="a-card-icon"><i class="fas fa-chart-bar"></i></div><span class="a-card-title">KPI Numbers</span></div>
          <div class="a-card-body">
            <div class="f-row">
              <div class="f-group"><label>Years of Experience</label><input id="h-years" type="number" placeholder="4"></div>
              <div class="f-group"><label>Tickets Resolved</label><input id="h-tickets" type="number" placeholder="500"></div>
              <div class="f-group"><label>SLA Compliance %</label><input id="h-sla" type="number" placeholder="95"></div>
            </div>
          </div>
        </div>

        <div class="a-card">
          <div class="a-card-head"><div class="a-card-icon"><i class="fas fa-link"></i></div><span class="a-card-title">Resume Link</span></div>
          <div class="a-card-body">
            <div class="f-group"><label>Google Drive / Resume URL</label><input id="h-resume" placeholder="https://drive.google.com/..."></div>
          </div>
        </div>
        <button class="btn-save" onclick="saveHero()"><i class="fas fa-save"></i> Save Changes</button>
      </div>

      <!-- ABOUT -->
      <div class="tab-panel" id="tab-about">
        <div class="panel-eyebrow"><span class="panel-eyebrow-rule"></span> Section 01</div>
        <h1 class="panel-heading">About Me</h1>
        <p class="panel-sub">Edit your bio text and achievement highlights.</p>

        <div class="a-card">
          <div class="a-card-head"><div class="a-card-icon"><i class="fas fa-align-left"></i></div><span class="a-card-title">Bio Text</span></div>
          <div class="a-card-body">
            <div class="f-group"><label>Lead Paragraph</label><textarea id="a-lead" rows="4"></textarea></div>
            <div class="f-group"><label>Second Paragraph</label><textarea id="a-body1" rows="3"></textarea></div>
            <div class="f-group"><label>Third Paragraph</label><textarea id="a-body2" rows="3"></textarea></div>
          </div>
        </div>

        <div class="a-card">
          <div class="a-card-head"><div class="a-card-icon"><i class="fas fa-trophy"></i></div><span class="a-card-title">Achievement Highlights</span></div>
          <div class="a-card-body">
            <div id="achievesList"></div>
            <button class="btn-add" onclick="addAchieve()"><i class="fas fa-plus"></i> Add Achievement</button>
          </div>
        </div>

        <div class="a-card">
          <div class="a-card-head"><div class="a-card-icon"><i class="fas fa-chart-pie"></i></div><span class="a-card-title">Performance Panel</span></div>
          <div class="a-card-body">
            <div class="f-row">
              <div class="f-group"><label>Systems Managed</label><input id="a-systems" placeholder="200+"></div>
              <div class="f-group"><label>Networks Configured</label><input id="a-networks" placeholder="50+"></div>
              <div class="f-group"><label>SLA Ring %</label><input id="a-sla" type="number" placeholder="95"></div>
            </div>
          </div>
        </div>
        <button class="btn-save" onclick="saveAbout()"><i class="fas fa-save"></i> Save Changes</button>
      </div>

      <!-- EDUCATION -->
      <div class="tab-panel" id="tab-education">
        <div class="panel-eyebrow"><span class="panel-eyebrow-rule"></span> Section 02</div>
        <h1 class="panel-heading">Education</h1>
        <p class="panel-sub">Edit your education history. Each entry becomes a tab on the portfolio.</p>
        <div id="eduList"></div>
        <button class="btn-add" onclick="addEdu()"><i class="fas fa-plus"></i> Add Education Entry</button>
        <br><br>
        <button class="btn-save" onclick="saveEducation()"><i class="fas fa-save"></i> Save Changes</button>
      </div>

      <!-- EXPERIENCE -->
      <div class="tab-panel" id="tab-experience">
        <div class="panel-eyebrow"><span class="panel-eyebrow-rule"></span> Section 03</div>
        <h1 class="panel-heading">Professional Experience</h1>
        <p class="panel-sub">Add, edit, or remove work experience entries. Most recent first.</p>
        <div id="expList"></div>
        <button class="btn-add" onclick="addExp()"><i class="fas fa-plus"></i> Add Experience</button>
        <br><br>
        <button class="btn-save" onclick="saveExperience()"><i class="fas fa-save"></i> Save Changes</button>
      </div>

      <!-- SKILLS -->
      <div class="tab-panel" id="tab-skills">
        <div class="panel-eyebrow"><span class="panel-eyebrow-rule"></span> Section 04</div>
        <h1 class="panel-heading">Skills &amp; Expertise</h1>
        <p class="panel-sub">Adjust skill names, proficiency levels, and your tech stack.</p>

        <div class="a-card">
          <div class="a-card-head"><div class="a-card-icon"><i class="fas fa-sliders-h"></i></div><span class="a-card-title">Core Skills</span></div>
          <div class="a-card-body">
            <div id="skillsList"></div>
            <button class="btn-add" onclick="addSkill()"><i class="fas fa-plus"></i> Add Skill</button>
          </div>
        </div>

        <div class="a-card">
          <div class="a-card-head"><div class="a-card-icon"><i class="fas fa-tags"></i></div><span class="a-card-title">Tech Stack Pills</span></div>
          <div class="a-card-body">
            <div class="f-group">
              <label>Technologies (one per line)</label>
              <textarea id="techStack" rows="10"></textarea>
              <span class="f-hint">Each line becomes a pill badge on your portfolio.</span>
            </div>
          </div>
        </div>

        <div class="a-card">
          <div class="a-card-head"><div class="a-card-icon"><i class="fas fa-language"></i></div><span class="a-card-title">Languages</span></div>
          <div class="a-card-body">
            <div id="langList"></div>
            <button class="btn-add" onclick="addLang()"><i class="fas fa-plus"></i> Add Language</button>
          </div>
        </div>
        <button class="btn-save" onclick="saveSkills()"><i class="fas fa-save"></i> Save Changes</button>
      </div>

      <!-- CERTIFICATIONS -->
      <div class="tab-panel" id="tab-certifications">
        <div class="panel-eyebrow"><span class="panel-eyebrow-rule"></span> Section 05</div>
        <h1 class="panel-heading">Certifications</h1>
        <p class="panel-sub">Edit your featured CCNA cert and additional certifications.</p>

        <div class="a-card">
          <div class="a-card-head"><div class="a-card-icon"><i class="fas fa-star"></i></div><span class="a-card-title">Featured Certification (CCNA)</span></div>
          <div class="a-card-body">
            <div class="f-row">
              <div class="f-group"><label>Title</label><input id="fc-title" placeholder="CCNA 200-301"></div>
              <div class="f-group"><label>Subtitle</label><input id="fc-subtitle" placeholder="Network Fundamentals"></div>
            </div>
            <div class="f-row">
              <div class="f-group"><label>Issuer</label><input id="fc-issuer" placeholder="Simplilearn SkillUp"></div>
              <div class="f-group"><label>Issue Date</label><input id="fc-date" placeholder="January 17, 2026"></div>
            </div>
            <div class="f-group"><label>Certificate Code</label><input id="fc-code" placeholder="9726449"></div>
            <div class="f-group"><label>Description</label><textarea id="fc-desc" rows="3"></textarea></div>
            <div class="f-group"><label>Certificate URL</label><input id="fc-url" placeholder="https://drive.google.com/..."></div>
          </div>
        </div>

        <div class="a-card">
          <div class="a-card-head"><div class="a-card-icon"><i class="fas fa-award"></i></div><span class="a-card-title">Additional Certifications</span></div>
          <div class="a-card-body">
            <div id="certsList"></div>
            <button class="btn-add" onclick="addCert()"><i class="fas fa-plus"></i> Add Certificate</button>
          </div>
        </div>
        <button class="btn-save" onclick="saveCerts()"><i class="fas fa-save"></i> Save Changes</button>
      </div>

      <!-- CONTACT -->
      <div class="tab-panel" id="tab-contact">
        <div class="panel-eyebrow"><span class="panel-eyebrow-rule"></span> Section 06</div>
        <h1 class="panel-heading">Contact Info</h1>
        <p class="panel-sub">Update your contact details and social links shown on the portfolio.</p>

        <div class="a-card">
          <div class="a-card-head"><div class="a-card-icon"><i class="fas fa-address-book"></i></div><span class="a-card-title">Contact Details</span></div>
          <div class="a-card-body">
            <div class="f-row">
              <div class="f-group"><label>Primary Email</label><input id="c-email1" type="email" placeholder="sajidmehmood@outlook.com"></div>
              <div class="f-group"><label>Secondary Email</label><input id="c-email2" type="email" placeholder="sajid@sajidmk.com"></div>
            </div>
            <div class="f-row">
              <div class="f-group"><label>Phone</label><input id="c-phone" placeholder="+974 6696 9598"></div>
              <div class="f-group"><label>Location</label><input id="c-location" placeholder="Doha, Qatar"></div>
            </div>
          </div>
        </div>

        <div class="a-card">
          <div class="a-card-head"><div class="a-card-icon"><i class="fas fa-share-alt"></i></div><span class="a-card-title">Social Links</span></div>
          <div class="a-card-body">
            <div class="f-group"><label><i class="fas fa-globe"></i> Website</label><input id="c-web" placeholder="https://sajidmk.com"></div>
            <div class="f-group"><label><i class="fab fa-linkedin"></i> LinkedIn URL</label><input id="c-linkedin" placeholder="https://www.linkedin.com/in/..."></div>
            <div class="f-group"><label><i class="fab fa-instagram"></i> Instagram URL</label><input id="c-instagram" placeholder="https://www.instagram.com/..."></div>
          </div>
        </div>
        <button class="btn-save" onclick="saveContact()"><i class="fas fa-save"></i> Save Changes</button>
      </div>

      <!-- CHANGE PASSWORD -->
      <div class="tab-panel" id="tab-password">
        <div class="panel-eyebrow"><span class="panel-eyebrow-rule"></span> Settings</div>
        <h1 class="panel-heading">Change Password</h1>
        <p class="panel-sub">Update your admin panel login credentials.</p>
        <div class="a-card">
          <div class="a-card-head"><div class="a-card-icon"><i class="fas fa-key"></i></div><span class="a-card-title">Update Credentials</span></div>
          <div class="a-card-body">
            <div class="f-group"><label>Username</label><input id="new-user" placeholder="sajid"></div>
            <div class="f-group"><label>New Password</label><input type="password" id="new-pass" placeholder="New password"></div>
            <div class="f-group"><label>Confirm Password</label><input type="password" id="new-pass2" placeholder="Repeat new password"></div>
            <p style="font-size:12px;color:var(--graphite-lt);margin-top:4px;font-family:'DM Mono',monospace">
              ⚠ Store your new password somewhere safe before saving.
            </p>
          </div>
        </div>
        <button class="btn-save" onclick="changePassword()"><i class="fas fa-save"></i> Update Password</button>
      </div>

      <!-- PUBLISH -->
      <div class="tab-panel" id="tab-publish">
        <div class="panel-eyebrow"><span class="panel-eyebrow-rule"></span> Deploy</div>
        <h1 class="panel-heading">Publish Changes</h1>
        <p class="panel-sub">One tap to push your edits live to <strong>sajidmk.com</strong> via GitHub.</p>

        <!-- ONE-TAP PUSH CARD -->
        <div class="a-card" id="pushReadyCard" style="display:none">
          <div class="a-card-head" style="background:linear-gradient(135deg,rgba(39,174,96,.1),rgba(39,174,96,.03));border-bottom-color:rgba(39,174,96,.2)">
            <div class="a-card-icon" style="background:linear-gradient(135deg,#27ae60,#2ecc71)"><i class="fas fa-rocket"></i></div>
            <span class="a-card-title" style="color:#1e8449">Ready to Publish</span>
          </div>
          <div class="a-card-body" style="text-align:center;padding:32px 24px">
            <p style="font-size:14px;color:var(--graphite-md);margin-bottom:24px;line-height:1.8">
              Token saved. Hit the button below — your changes go live on
              <strong>github.com/Sajidaitech/profile</strong> in seconds.
            </p>
            <button class="push-big-btn" onclick="pushToGitHub()">
              <i class="fab fa-github"></i>
              Push Live Now
            </button>
            <p id="ghStatus" style="margin-top:18px;font-family:'DM Mono',monospace;font-size:12px;min-height:18px;color:var(--graphite-lt)"></p>
            <button onclick="showTokenSetup()" style="margin-top:16px;background:none;border:none;font-family:'DM Mono',monospace;font-size:11px;color:var(--graphite-xl);cursor:pointer;text-decoration:underline">
              Change token
            </button>
          </div>
        </div>

        <!-- FIRST-TIME TOKEN SETUP -->
        <div class="a-card" id="tokenSetupCard">
          <div class="a-card-head">
            <div class="a-card-icon"><i class="fas fa-key"></i></div>
            <span class="a-card-title">One-Time Setup — GitHub Token</span>
          </div>
          <div class="a-card-body">

            <div class="token-steps">
              <div class="token-step">
                <div class="token-step-num">1</div>
                <div class="token-step-body">
                  <strong>Open GitHub in a new tab</strong>
                  <p>Click the button below — it takes you straight to the token creation page.</p>
                  <a href="https://github.com/settings/tokens/new?description=portfolio-admin&scopes=repo" target="_blank" rel="noopener noreferrer" class="btn-github" style="display:inline-flex;margin-top:10px">
                    <i class="fab fa-github"></i> Open GitHub Token Page
                  </a>
                </div>
              </div>
              <div class="token-step">
                <div class="token-step-num">2</div>
                <div class="token-step-body">
                  <strong>Generate the token</strong>
                  <p>On the GitHub page: give it any name → tick <code>repo</code> checkbox → scroll down → click <strong>Generate token</strong>.</p>
                </div>
              </div>
              <div class="token-step">
                <div class="token-step-num">3</div>
                <div class="token-step-body">
                  <strong>Paste it here — once only</strong>
                  <p>Copy the token (starts with <code>ghp_</code>) and paste below. It's saved permanently on this device.</p>
                  <div class="token-input-wrap">
                    <input type="password" id="gh-token" placeholder="ghp_xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx"
                           autocomplete="off" spellcheck="false">
                    <button class="token-toggle-btn" onclick="toggleTokenVis()" title="Show/hide">
                      <i class="fas fa-eye" id="tokenEyeIcon"></i>
                    </button>
                  </div>
                  <button class="btn-save" style="margin-top:14px;width:100%;justify-content:center" onclick="saveTokenAndReady()">
                    <i class="fas fa-check"></i> Save Token &amp; Activate Push
                  </button>
                  <p id="tokenErr" style="margin-top:10px;font-family:'DM Mono',monospace;font-size:12px;color:var(--red);min-height:16px"></p>
                </div>
              </div>
            </div>

          </div>
        </div>

        <!-- STATUS / LAST PUSH -->
        <div class="a-card" id="lastPushCard" style="display:none">
          <div class="a-card-head"><div class="a-card-icon"><i class="fas fa-history"></i></div><span class="a-card-title">Last Push</span></div>
          <div class="a-card-body">
            <p id="lastPushInfo" style="font-family:'DM Mono',monospace;font-size:12px;color:var(--graphite-lt)"></p>
          </div>
        </div>

        <!-- BACKUP DOWNLOAD -->
        <div class="a-card">
          <div class="a-card-head"><div class="a-card-icon"><i class="fas fa-download"></i></div><span class="a-card-title">Backup — Download script.js</span></div>
          <div class="a-card-body">
            <p style="font-size:14px;color:var(--graphite-md);margin-bottom:16px;line-height:1.8">
              Download a local copy of your updated <code>script.js</code> as a backup.
            </p>
            <button class="btn-download" onclick="downloadScript()">
              <i class="fas fa-download"></i> Download script.js
            </button>
          </div>
        </div>

      </div>

    </main>
  </div><!-- /admin-body -->
</div><!-- /adminApp -->

<div id="saveToast"><i class="fas fa-check-circle"></i> Saved successfully!</div>

<script>
// ════════════════════════════════════════
// AUTH
// ════════════════════════════════════════
const DEFAULT_USER = 'sajid';
const DEFAULT_PASS = 'sajid2020';

function getCreds() {
  return {
    user: localStorage.getItem('adm_user') || DEFAULT_USER,
    pass: localStorage.getItem('adm_pass') || DEFAULT_PASS
  };
}
function doLogin() {
  const u = document.getElementById('loginUser').value.trim();
  const p = document.getElementById('loginPass').value.trim();
  const creds = getCreds();
  if (u === creds.user && p === creds.pass) {
    sessionStorage.setItem('adm_auth', '1');
    document.getElementById('loginScreen').style.display = 'none';
    document.getElementById('adminApp').style.display = 'block';
    initAdmin();
  } else {
    document.getElementById('loginErr').textContent = '✕ Incorrect username or password.';
  }
}
function logout() {
  sessionStorage.removeItem('adm_auth');
  location.reload();
}
function changePassword() {
  const u = document.getElementById('new-user').value.trim();
  const p = document.getElementById('new-pass').value.trim();
  const p2 = document.getElementById('new-pass2').value.trim();
  if (!u || !p) return alert('Please fill in username and password.');
  if (p !== p2) return alert('Passwords do not match.');
  localStorage.setItem('adm_user', u);
  localStorage.setItem('adm_pass', p);
  showToast();
}
if (sessionStorage.getItem('adm_auth') === '1') {
  document.getElementById('loginScreen').style.display = 'none';
  document.getElementById('adminApp').style.display = 'block';
  window.addEventListener('DOMContentLoaded', initAdmin);
}

// ════════════════════════════════════════
// NAVIGATION
// ════════════════════════════════════════
function showTab(name, el) {
  document.querySelectorAll('.tab-panel').forEach(p => p.classList.remove('active'));
  document.querySelectorAll('.sb-link').forEach(a => a.classList.remove('active'));
  document.getElementById('tab-' + name).classList.add('active');
  if (el) el.classList.add('active');
  if (window.innerWidth <= 768) document.getElementById('adminSidebar').classList.remove('open');
  window.scrollTo(0, 0);
}
function toggleSidebar() {
  document.getElementById('adminSidebar').classList.toggle('open');
}
function showToast() {
  const t = document.getElementById('saveToast');
  t.style.display = 'flex';
  setTimeout(() => { t.style.display = 'none'; }, 2600);
}

// ════════════════════════════════════════
// DEFAULT DATA
// ════════════════════════════════════════
const DEFAULTS = {
  hero: { name:'Sajid Mehmood', title:'IT Support Engineer', location:'Doha, Qatar', avail:'Available for Opportunities', line1:'From Hospitals to Airports —', line2:'I Keep IT', line3:'Running.', brief:'CCNA-certified IT Support Engineer with 4+ years of experience in healthcare, telecom, and immigration sectors. Skilled in hardware, software, and network troubleshooting — delivering Level 1 & Level 2 support that keeps businesses operational.', years:4, tickets:500, sla:95, resume:'https://drive.google.com/file/d/1bS0MO-9GPHlz359Fdq3ebmvLHnKlmy2t/view?usp=drive_link' },
  about: {
    lead:"I'm Sajid Mehmood, a CCNA-certified IT Support Engineer with over 4 years of hands-on experience in healthcare, telecom, and immigration sectors. I specialise in hardware, software, and network troubleshooting — delivering Level 1 and Level 2 support that users can rely on.",
    body1:"I have proven experience managing IT assets, deploying systems, and training staff. My focus on proactive maintenance and fast resolution has helped me maintain a consistent 95% SLA compliance record across every role I've held.",
    body2:"Currently based in Doha, Qatar, I'm open to new opportunities where reliability, speed, and technical depth are valued.",
    systems:'200+', networks:'50+', sla:95,
    achieves:[{icon:'fa-trophy',title:'Safety Award — HIA Airport Project',desc:'Recognition for exemplary safety practices'},{icon:'fa-chart-line',title:'Consistent 95% SLA Compliance',desc:'Maintained across all projects and roles'},{icon:'fa-industry',title:'Multi-Sector Experience',desc:'Healthcare · Telecom · Immigration · Aviation'}]
  },
  education:[{date:'Sep 2024 – Jun 2025',degree:'Bachelor of Science in Information Technology',inst:'Middlesex University Dubai',note:'Expected Graduation: 2025',url:'https://drive.google.com/file/d/17IYNcUbLLQfEJS0_4VtscE6xejH7p4XB/view?usp=sharing'},{date:'Nov 2020 – Nov 2023',degree:'Advanced Diploma in Software Engineering',inst:'Aptech Qatar',note:'ACCP Certification',url:'https://drive.google.com/file/d/1J_d7bN2xAYlI33Uzp5YQPZ3kt8fFHamy/view?usp=sharing'},{date:'Sep 2017 – Jul 2018',degree:'IGCSE',inst:'Bright Future International School',note:'Cambridge International Examination',url:''}],
  experience:[{date:'Apr 2025 – Aug 2025',title:'IT Executive & Business Development Intern',type:'Internship',company:'Al Tawkel Immigration Center · Dubai, UAE',resp:'Delivered Level 2 IT support including hardware repairs, system reimaging, network troubleshooting, and Office 365 email configurations\nInstalled, configured, and maintained enterprise IT infrastructure (servers, networks, printers)\nCreated and maintained digital IT asset records, streamlining lifecycle management\nAssisted with immigration business operations including visa applications, cancellations, and Golden Visa processing\nCoordinated with government authorities to resolve absconding employee cases, overstay fines, and lost passports',letterText:'Experience Letter',letterUrl:'https://drive.google.com/file/d/1N8q3F1iHs38fhDz8FI1teS1ZOXaQ6CYP/view?usp=sharing'},{date:'Nov 2023 – Feb 2024',title:'IT Support Engineer',type:'Short-term Project',company:'Military Medical City Hospital (MMCH) · Doha, Qatar',resp:'Managed 500+ support tickets across three hospitals, ensuring 95% SLA compliance\nHandled L1 tasks (password resets, software installs, network fixes) and L2 troubleshooting (OS crashes, hardware failures)\nPerformed system reimaging, OS deployment, and application configuration for 300+ medical staff\nSupported EMR application troubleshooting for doctors and nurses, reducing downtime\nConducted preventive maintenance and patching for compliance with IT policies\nMaintained digital asset inventory, improving lifecycle management accuracy',letterText:'Experience Letter',letterUrl:'https://drive.google.com/file/d/161PTtyekepRwmq8FS3T45V5R6VXDTSya/view?usp=sharing'},{date:'Feb 2022 – Nov 2023',title:'IT Support Engineer',type:'Full Time',company:'Star Link – Power International Holding · Doha, Qatar',resp:'Delivered daily IT support for 200+ staff across retail and corporate offices\nResolved L1 issues: login errors, email configs, printer problems, software installations\nHandled L2 incidents: hardware replacements, OS troubleshooting, network failures\nPerformed imaging, upgrades, and preventive maintenance for desktops, laptops, POS systems\nMonitored and documented IT assets, reducing missing equipment by 20%\nCollaborated with vendors and telecoms for VoIP/connectivity issues\nSupported onboarding (device provisioning, account setup, access control)\nTrained staff on troubleshooting and IT best practices, reducing repeat tickets',letterText:'Starlink Experience Letter',letterUrl:'https://drive.google.com/file/d/16Sm6njPJ4bA2mw7NlzwJW1Xa1I_Dpdnd/view?usp=sharing'},{date:'May 2021 – Feb 2022',title:'Customer Service Agent',type:'Full Time',company:'STARLINK (Ooredoo International Telecommunications Company) · Qatar',resp:'Handled inbound/outbound customer calls, resolving service and product issues\nIdentified customer needs, researched solutions, and provided appropriate alternatives\nSupported customers with network and technical issues across Ooredoo products\nMaintained accurate call records in database systems\nEngaged customers and built sustainable long-term relationships\nRegularly attended training sessions to improve product knowledge and performance',letterText:'Experience Letter',letterUrl:'https://drive.google.com/file/d/1F1dRuB9Bp3aLm0M2A0RZ_xmzFoYaElKp/view?usp=sharing'}],
  skills:[{name:'L1 & L2 IT Support',icon:'fa-headset',level:85,cat:'Core Competency'},{name:'Hardware Repair & Maint.',icon:'fa-tools',level:82,cat:'Hands-on Experience'},{name:'System Reimaging & OS Deploy',icon:'fa-compact-disc',level:80,cat:'Practiced Regularly'},{name:'Network Support (LAN/WAN)',icon:'fa-network-wired',level:78,cat:'CCNA Foundation'},{name:'IT Asset Management',icon:'fa-database',level:75,cat:'Full Lifecycle'},{name:'Office 365 & SharePoint',icon:'fa-envelope-open',level:80,cat:'Daily Use'},{name:'Onboarding IT Processes',icon:'fa-user-plus',level:72,cat:'Multi-company Experience'},{name:'H/W, S/W & OS Troubleshoot',icon:'fa-bug',level:83,cat:'Expert Level'},{name:'Digital Asset Inventory',icon:'fa-clipboard-list',level:76,cat:'Cross-sector Practice'}],
  techStack:['Windows 10 / 11','macOS','Office 365','SharePoint','Active Directory','Outlook','Microsoft Teams','LAN / WAN / Wi-Fi','VoIP','Network Troubleshooting','TCP/IP','System Reimaging','Hardware Repair','EMR Systems','POS Systems','SQL Basics','Project Management','Odoo ERP'],
  languages:[{name:'English',level:'Professional'},{name:'Urdu / Hindi',level:'Native'},{name:'Pashto',level:'Native'}],
  featuredCert:{title:'CCNA 200-301',subtitle:'Network Fundamentals',issuer:'Simplilearn SkillUp',date:'January 17, 2026',code:'9726449',desc:'Covering network fundamentals, routing protocols, switching technologies, and enterprise network security principles.',url:'https://drive.google.com/file/d/18ZVcmGVI9DFaDImxK2py2AezvOP03YG8/view?usp=sharing'},
  certs:[{icon:'fa-graduation-cap',title:'Odoo ERP Training',desc:'Workshop covering business processes, product, vendor, and customer management.',url:'https://drive.google.com/file/d/1o6rcKtNQfHl7pH0Hyj0UqEkvFrloo18l/view?usp=sharing'},{icon:'fa-trophy',title:'Aptech Graduation',desc:'Advanced Diploma in Software Engineering (ACCP) certification.',url:'https://drive.google.com/file/d/1lOtZX9l8Gd1d_H60vcFm4SQUgHyQ5UAx/view?usp=drive_link'},{icon:'fa-hands-helping',title:'MDX Career Fair',desc:'Certificate of appreciation for volunteering at the Middlesex University Career Fair.',url:'https://drive.google.com/file/d/1xMiN9VHdOAJg4D7CowQnaCYCyejLmay8/view?usp=sharing'},{icon:'fa-award',title:'Safety Award — HIA',desc:'Recognition for exemplary safety practices during the Airport Expansion Project.',url:'https://drive.google.com/file/d/1fJPZr1Ju_TOxwXkYcVGbGi5HcFh4lrN9/view?usp=drive_link'}],
  contact:{email1:'sajidmehmood@outlook.com',email2:'sajid@sajidmk.com',phone:'+974 6696 9598',location:'Doha, Qatar',web:'https://sajidmk.com',linkedin:'https://www.linkedin.com/in/sajid-t-1b3954333',instagram:'https://www.instagram.com/sajidteech'}
};

function getData(key) {
  const raw = localStorage.getItem('pd_' + key);
  return raw ? JSON.parse(raw) : DEFAULTS[key];
}
function setData(key, val) {
  localStorage.setItem('pd_' + key, JSON.stringify(val));
}

// ════════════════════════════════════════
// INIT
// ════════════════════════════════════════
function initAdmin() {
  loadHeroForm(); loadAboutForm(); loadEduForm(); loadExpForm();
  loadSkillsForm(); loadCertsForm(); loadContactForm(); updateDashboard();
  initPublishUI();
  // restore github token in setup form if present
  const tok = localStorage.getItem('gh_token');
  if (tok) { const el = document.getElementById('gh-token'); if(el) el.value = tok; }
}

// ════════════════════════════════════════
// DASHBOARD
// ════════════════════════════════════════
function updateDashboard() {
  const exp = getData('experience');
  const skills = getData('skills');
  const certs = getData('certs');
  const edu = getData('education');
  document.getElementById('dashStats').innerHTML = `
    <div class="dash-stat"><div class="ds-num">${exp.length}</div><div class="ds-lbl">Jobs Listed</div></div>
    <div class="dash-stat"><div class="ds-num">${skills.length}</div><div class="ds-lbl">Skills</div></div>
    <div class="dash-stat"><div class="ds-num">${certs.length + 1}</div><div class="ds-lbl">Certifications</div></div>
    <div class="dash-stat"><div class="ds-num">${edu.length}</div><div class="ds-lbl">Education</div></div>
  `;
}

// ════════════════════════════════════════
// HERO
// ════════════════════════════════════════
function loadHeroForm() {
  const d = getData('hero');
  ['name','title','location','avail','line1','line2','line3','brief','years','tickets','sla','resume'].forEach(k => {
    const el = document.getElementById('h-'+k); if(el) el.value = d[k];
  });
}
function saveHero() {
  setData('hero', { name:v('h-name'), title:v('h-title'), location:v('h-location'), avail:v('h-avail'), line1:v('h-line1'), line2:v('h-line2'), line3:v('h-line3'), brief:v('h-brief'), years:+v('h-years'), tickets:+v('h-tickets'), sla:+v('h-sla'), resume:v('h-resume') });
  showToast(); updateDashboard();
}

// ════════════════════════════════════════
// ABOUT
// ════════════════════════════════════════
function loadAboutForm() {
  const d = getData('about');
  ['lead','body1','body2','systems','networks','sla'].forEach(k => {
    const el = document.getElementById('a-'+k); if(el) el.value = d[k];
  });
  renderAchieves(d.achieves);
}
function renderAchieves(list) {
  document.getElementById('achievesList').innerHTML = list.map((a, i) => `
    <div class="repeat-item">
      <div class="repeat-item-head">
        <span class="repeat-item-num">Achievement ${i+1}</span>
        <button class="btn-remove" onclick="removeAchieve(${i})"><i class="fas fa-times"></i> Remove</button>
      </div>
      <div class="f-row">
        <div class="f-group"><label>Title</label><input id="ach-title-${i}" value="${esc(a.title)}"></div>
        <div class="f-group"><label>Description</label><input id="ach-desc-${i}" value="${esc(a.desc)}"></div>
      </div>
    </div>`).join('');
}
function addAchieve() {
  const d = getData('about');
  d.achieves.push({ icon: 'fa-star', title: 'New Achievement', desc: 'Description here' });
  setData('about', d); renderAchieves(d.achieves);
}
function removeAchieve(i) {
  const d = getData('about');
  d.achieves.splice(i, 1); setData('about', d); renderAchieves(d.achieves);
}
function saveAbout() {
  const d = getData('about');
  const achieves = d.achieves.map((a,i) => ({ icon: a.icon||'fa-star', title: v(`ach-title-${i}`), desc: v(`ach-desc-${i}`) }));
  setData('about', { lead:v('a-lead'), body1:v('a-body1'), body2:v('a-body2'), systems:v('a-systems'), networks:v('a-networks'), sla:+v('a-sla'), achieves });
  showToast();
}

// ════════════════════════════════════════
// EDUCATION
// ════════════════════════════════════════
function loadEduForm() { renderEdu(getData('education')); }
function renderEdu(list) {
  document.getElementById('eduList').innerHTML = list.map((e, i) => `
    <div class="repeat-item">
      <div class="repeat-item-head">
        <span class="repeat-item-num">Entry ${i+1}</span>
        <button class="btn-remove" onclick="removeEdu(${i})"><i class="fas fa-times"></i> Remove</button>
      </div>
      <div class="f-row">
        <div class="f-group"><label>Date Range</label><input id="edu-date-${i}" value="${esc(e.date)}"></div>
        <div class="f-group"><label>Institution</label><input id="edu-inst-${i}" value="${esc(e.inst)}"></div>
      </div>
      <div class="f-group"><label>Degree / Qualification</label><input id="edu-degree-${i}" value="${esc(e.degree)}"></div>
      <div class="f-row">
        <div class="f-group"><label>Note</label><input id="edu-note-${i}" value="${esc(e.note)}"></div>
        <div class="f-group"><label>Certificate URL</label><input id="edu-url-${i}" value="${esc(e.url)}"></div>
      </div>
    </div>`).join('');
}
function addEdu() {
  const d = getData('education');
  d.unshift({ date:'', degree:'', inst:'', note:'', url:'' });
  setData('education', d); renderEdu(d);
}
function removeEdu(i) {
  const d = getData('education');
  d.splice(i, 1); setData('education', d); renderEdu(d);
}
function saveEducation() {
  const d = getData('education');
  const saved = d.map((_,i) => ({ date:v(`edu-date-${i}`), degree:v(`edu-degree-${i}`), inst:v(`edu-inst-${i}`), note:v(`edu-note-${i}`), url:v(`edu-url-${i}`) }));
  setData('education', saved); showToast(); updateDashboard();
}

// ════════════════════════════════════════
// EXPERIENCE
// ════════════════════════════════════════
function loadExpForm() { renderExp(getData('experience')); }
function renderExp(list) {
  document.getElementById('expList').innerHTML = list.map((e, i) => `
    <div class="repeat-item">
      <div class="repeat-item-head">
        <span class="repeat-item-num">Position ${i+1}</span>
        <button class="btn-remove" onclick="removeExp(${i})"><i class="fas fa-times"></i> Remove</button>
      </div>
      <div class="f-row">
        <div class="f-group"><label>Job Title</label><input id="exp-title-${i}" value="${esc(e.title)}"></div>
        <div class="f-group"><label>Type</label><input id="exp-type-${i}" value="${esc(e.type)}"></div>
      </div>
      <div class="f-row">
        <div class="f-group"><label>Company & Location</label><input id="exp-company-${i}" value="${esc(e.company)}"></div>
        <div class="f-group"><label>Date Range</label><input id="exp-date-${i}" value="${esc(e.date)}"></div>
      </div>
      <div class="f-group">
        <label>Responsibilities (one per line)</label>
        <textarea id="exp-resp-${i}" rows="6">${esc(e.resp)}</textarea>
        <span class="f-hint">Each new line becomes a bullet point on the portfolio.</span>
      </div>
      <div class="f-row">
        <div class="f-group"><label>Letter Button Text</label><input id="exp-ltxt-${i}" value="${esc(e.letterText||'')}"></div>
        <div class="f-group"><label>Letter URL</label><input id="exp-lurl-${i}" value="${esc(e.letterUrl||'')}"></div>
      </div>
    </div>`).join('');
}
function addExp() {
  const d = getData('experience');
  d.unshift({ date:'', title:'New Position', type:'Full Time', company:'', resp:'', letterText:'Experience Letter', letterUrl:'' });
  setData('experience', d); renderExp(d);
}
function removeExp(i) {
  const d = getData('experience');
  d.splice(i, 1); setData('experience', d); renderExp(d);
}
function saveExperience() {
  const d = getData('experience');
  const saved = d.map((_,i) => ({ title:v(`exp-title-${i}`), type:v(`exp-type-${i}`), company:v(`exp-company-${i}`), date:v(`exp-date-${i}`), resp:v(`exp-resp-${i}`), letterText:v(`exp-ltxt-${i}`), letterUrl:v(`exp-lurl-${i}`) }));
  setData('experience', saved); showToast(); updateDashboard();
}

// ════════════════════════════════════════
// SKILLS
// ════════════════════════════════════════
function loadSkillsForm() {
  renderSkills(getData('skills'));
  document.getElementById('techStack').value = getData('techStack').join('\n');
  renderLangs(getData('languages'));
}
function renderSkills(list) {
  document.getElementById('skillsList').innerHTML = list.map((s, i) => `
    <div class="repeat-item">
      <div class="repeat-item-head">
        <span class="repeat-item-num">Skill ${i+1}</span>
        <button class="btn-remove" onclick="removeSkill(${i})"><i class="fas fa-times"></i> Remove</button>
      </div>
      <div class="f-row">
        <div class="f-group"><label>Skill Name</label><input id="sk-name-${i}" value="${esc(s.name)}"></div>
        <div class="f-group"><label>Category Label</label><input id="sk-cat-${i}" value="${esc(s.cat)}"></div>
      </div>
      <div class="f-group">
        <label>Proficiency — <span id="sk-val-${i}">${s.level}%</span></label>
        <div class="range-row">
          <input type="range" min="10" max="100" value="${s.level}" id="sk-lvl-${i}"
            oninput="document.getElementById('sk-val-${i}').textContent=this.value+'%'">
          <span class="range-num">${s.level}%</span>
        </div>
      </div>
    </div>`).join('');
}
function addSkill() {
  const d = getData('skills');
  d.push({ name:'New Skill', icon:'fa-star', level:70, cat:'Intermediate' });
  setData('skills', d); renderSkills(d);
}
function removeSkill(i) {
  const d = getData('skills');
  d.splice(i, 1); setData('skills', d); renderSkills(d);
}
function renderLangs(list) {
  document.getElementById('langList').innerHTML = list.map((l, i) => `
    <div class="repeat-item">
      <div class="repeat-item-head">
        <span class="repeat-item-num">Language ${i+1}</span>
        <button class="btn-remove" onclick="removeLang(${i})"><i class="fas fa-times"></i> Remove</button>
      </div>
      <div class="f-row">
        <div class="f-group"><label>Language</label><input id="lang-name-${i}" value="${esc(l.name)}"></div>
        <div class="f-group"><label>Level</label><input id="lang-lvl-${i}" value="${esc(l.level)}"></div>
      </div>
    </div>`).join('');
}
function addLang() {
  const d = getData('languages');
  d.push({ name:'', level:'' }); setData('languages', d); renderLangs(d);
}
function removeLang(i) {
  const d = getData('languages');
  d.splice(i, 1); setData('languages', d); renderLangs(d);
}
function saveSkills() {
  const skillsD = getData('skills');
  const saved = skillsD.map((s,i) => ({ name:v(`sk-name-${i}`), icon:s.icon, cat:v(`sk-cat-${i}`), level:+document.getElementById(`sk-lvl-${i}`).value }));
  setData('skills', saved);
  setData('techStack', document.getElementById('techStack').value.split('\n').map(t=>t.trim()).filter(Boolean));
  const langsD = getData('languages');
  const langs = langsD.map((_,i) => ({ name:v(`lang-name-${i}`), level:v(`lang-lvl-${i}`) }));
  setData('languages', langs);
  showToast(); updateDashboard();
}

// ════════════════════════════════════════
// CERTIFICATIONS
// ════════════════════════════════════════
function loadCertsForm() {
  const fc = getData('featuredCert');
  ['title','subtitle','issuer','date','code','desc','url'].forEach(k => {
    const el = document.getElementById('fc-'+k); if(el) el.value = fc[k];
  });
  renderCerts(getData('certs'));
}
function renderCerts(list) {
  document.getElementById('certsList').innerHTML = list.map((c, i) => `
    <div class="repeat-item">
      <div class="repeat-item-head">
        <span class="repeat-item-num">Certificate ${i+1}</span>
        <button class="btn-remove" onclick="removeCert(${i})"><i class="fas fa-times"></i> Remove</button>
      </div>
      <div class="f-row">
        <div class="f-group"><label>Title</label><input id="cert-title-${i}" value="${esc(c.title)}"></div>
        <div class="f-group"><label>Description</label><input id="cert-desc-${i}" value="${esc(c.desc)}"></div>
      </div>
      <div class="f-group"><label>Certificate URL</label><input id="cert-url-${i}" value="${esc(c.url)}"></div>
    </div>`).join('');
}
function addCert() {
  const d = getData('certs');
  d.push({ icon:'fa-award', title:'', desc:'', url:'' });
  setData('certs', d); renderCerts(d);
}
function removeCert(i) {
  const d = getData('certs');
  d.splice(i, 1); setData('certs', d); renderCerts(d);
}
function saveCerts() {
  setData('featuredCert', { title:v('fc-title'), subtitle:v('fc-subtitle'), issuer:v('fc-issuer'), date:v('fc-date'), code:v('fc-code'), desc:v('fc-desc'), url:v('fc-url') });
  const d = getData('certs');
  const saved = d.map((c,i) => ({ icon:c.icon, title:v(`cert-title-${i}`), desc:v(`cert-desc-${i}`), url:v(`cert-url-${i}`) }));
  setData('certs', saved); showToast(); updateDashboard();
}

// ════════════════════════════════════════
// CONTACT
// ════════════════════════════════════════
function loadContactForm() {
  const d = getData('contact');
  ['email1','email2','phone','location','web','linkedin','instagram'].forEach(k => {
    const el = document.getElementById('c-'+k); if(el) el.value = d[k];
  });
}
function saveContact() {
  setData('contact', { email1:v('c-email1'), email2:v('c-email2'), phone:v('c-phone'), location:v('c-location'), web:v('c-web'), linkedin:v('c-linkedin'), instagram:v('c-instagram') });
  showToast();
}

// ════════════════════════════════════════
// GITHUB PUSH — core function
// ════════════════════════════════════════

async function saveToGitHub(token) {
    const owner = "Sajidaitech";
    const repo = "profile";
    const path = "script.js";
    const message = "Update from Admin Panel";
    const newContent = buildScript();

    // 1. Get the current file's SHA (GitHub needs this to update)
    const getFile = await fetch(`https://api.github.com/repos/${owner}/${repo}/contents/${path}`, {
        headers: { "Authorization": `Bearer ${token}` }
    });
    const fileData = await getFile.json();
    const sha = fileData.sha;

    // 2. Upload the new version
    const response = await fetch(`https://api.github.com/repos/${owner}/${repo}/contents/${path}`, {
        method: "PUT",
        headers: {
            "Authorization": `Bearer ${token}`,
            "Content-Type": "application/json",
        },
        body: JSON.stringify({
            message: message,
            content: btoa(unescape(encodeURIComponent(newContent))),
            sha: sha
        })
    });

    if (response.ok) {
        return { ok: true };
    } else {
        const err = await response.json();
        return { ok: false, status: response.status, message: err.message || response.statusText };
    }
}

// ── Publish tab push button ──
async function pushToGitHub() {
    const token = localStorage.getItem('gh_token');
    const status = document.getElementById('ghStatus');
    const pushBtn = document.querySelector('.push-big-btn');
    if (!token) { showTokenSetup(); return; }

    if (pushBtn) { pushBtn.disabled = true; pushBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Pushing...'; }
    status.style.color = 'var(--graphite-lt)';
    status.textContent = '⏳ Pushing to GitHub...';

    const result = await saveToGitHub(token);

    if (result.ok) {
        const ts = new Date().toLocaleString();
        localStorage.setItem('gh_last_push', ts);
        status.style.color = 'var(--green)';
        status.textContent = '✓ Live! GitHub Pages updates in ~1 min. Hard-refresh sajidmk.com to see changes.';
        showLastPush();
    } else {
        if (result.status === 401) { localStorage.removeItem('gh_token'); showTokenSetup(); }
        status.style.color = 'var(--red)';
        status.textContent = '✕ ' + (result.message || 'Unknown error');
    }
    if (pushBtn) { pushBtn.disabled = false; pushBtn.innerHTML = '<i class="fab fa-github"></i> Push Live Now'; }
}

// ── Dashboard quick push button ──
async function dashPush() {
    const token = localStorage.getItem('gh_token');
    const status = document.getElementById('dashPushStatus');
    const btn = document.getElementById('dashPushBtn');

    if (!token) {
        // No token yet — navigate to setup
        document.querySelectorAll('.tab-panel').forEach(p => p.classList.remove('active'));
        document.querySelectorAll('.sb-link').forEach(a => a.classList.remove('active'));
        document.getElementById('tab-publish').classList.add('active');
        document.querySelectorAll('.sb-link').forEach(a => { if(a.textContent.includes('Publish')) a.classList.add('active'); });
        return;
    }

    btn.disabled = true;
    btn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Pushing...';
    status.style.color = 'var(--graphite-lt)';
    status.textContent = '⏳ Pushing to GitHub...';

    const result = await saveToGitHub(token);

    if (result.ok) {
        const ts = new Date().toLocaleString();
        localStorage.setItem('gh_last_push', ts);
        status.style.color = 'var(--green)';
        status.textContent = '✓ Live! Site updates in ~1 min.';
        document.getElementById('dashLastPush').textContent = 'Last push: ' + ts;
    } else {
        if (result.status === 401) { localStorage.removeItem('gh_token'); }
        status.style.color = 'var(--red)';
        status.textContent = '✕ ' + (result.message || 'Unknown error');
    }
    btn.disabled = false;
    btn.innerHTML = '<i class="fab fa-github"></i> Push Live';
}

// ── Publish UI helpers ──
function initPublishUI() {
    const token = localStorage.getItem('gh_token');
    if (token) {
        document.getElementById('pushReadyCard').style.display = 'block';
        document.getElementById('tokenSetupCard').style.display = 'none';
        showLastPush();
    } else {
        document.getElementById('pushReadyCard').style.display = 'none';
        document.getElementById('tokenSetupCard').style.display = 'block';
    }
    const last = localStorage.getItem('gh_last_push');
    const dashLast = document.getElementById('dashLastPush');
    if (last && dashLast) dashLast.textContent = 'Last push: ' + last;
}

function showTokenSetup() {
    document.getElementById('pushReadyCard').style.display = 'none';
    document.getElementById('tokenSetupCard').style.display = 'block';
}

function saveTokenAndReady() {
    const token = document.getElementById('gh-token').value.trim();
    const err = document.getElementById('tokenErr');
    if (!token || !token.startsWith('ghp_')) {
        err.textContent = '✕ Token must start with ghp_ — please check and try again.';
        return;
    }
    err.textContent = '';
    localStorage.setItem('gh_token', token);
    document.getElementById('pushReadyCard').style.display = 'block';
    document.getElementById('tokenSetupCard').style.display = 'none';
}

function toggleTokenVis() {
    const input = document.getElementById('gh-token');
    const icon  = document.getElementById('tokenEyeIcon');
    if (input.type === 'password') { input.type = 'text'; icon.className = 'fas fa-eye-slash'; }
    else { input.type = 'password'; icon.className = 'fas fa-eye'; }
}

function showLastPush() {
    const last = localStorage.getItem('gh_last_push');
    if (!last) return;
    const card = document.getElementById('lastPushCard');
    const info = document.getElementById('lastPushInfo');
    if (card && info) { card.style.display = 'block'; info.textContent = '✓ Last push: ' + last; }
}

// ════════════════════════════════════════
// BUILD & DOWNLOAD script.js
// ════════════════════════════════════════
function buildScript() {
  const hero = getData('hero');
  const about = getData('about');
  const edu = getData('education');
  const exp = getData('experience');
  const skills = getData('skills');
  const tech = getData('techStack');
  const langs = getData('languages');
  const fc = getData('featuredCert');
  const certs = getData('certs');
  const contact = getData('contact');

  const expStr = exp.map(e => {
    const resps = e.resp.split('\n').filter(Boolean);
    const letters = [];
    if (e.letterText && e.letterUrl) letters.push({ text: e.letterText, url: e.letterUrl });
    return `{
        date: '${es(e.date)}',
        title: '${es(e.title)}',
        type: '${es(e.type)}',
        company: '${es(e.company)}',
        responsibilities: [${resps.map(r => `\n            '${es(r)}'`).join(',')}
        ],
        letters: [${letters.map(l => `{ text: '${es(l.text)}', url: '${es(l.url)}' }`).join(', ')}]
    }`;
  }).join(',\n    ');

  const skillsStr = skills.map(s => `    { name: '${es(s.name)}', icon: '${s.icon}', level: ${s.level}, cat: '${es(s.cat)}' }`).join(',\n');
  const techStr = tech.map(t => `    '${es(t)}'`).join(',\n');
  const langsStr = langs.map(l => `    { name: '${es(l.name)}', level: '${es(l.level)}' }`).join(',\n');
  const certsStr = certs.map(c => `    { icon: '${c.icon}', title: '${es(c.title)}', desc: '${es(c.desc)}', url: '${es(c.url)}' }`).join(',\n');
  const eduStr = edu.map(e => `    { date: '${es(e.date)}', degree: '${es(e.degree)}', inst: '${es(e.inst)}', note: '${es(e.note)}', url: '${es(e.url)}' }`).join(',\n');

  return `// ============================================
// Portfolio JavaScript — Auto-generated by Admin Panel
// Sajid Mehmood · IT Support Engineer
// Last updated: ${new Date().toLocaleString()}
// ============================================

const PORTFOLIO = {
  hero: ${JSON.stringify(hero, null, 2)},
  about: ${JSON.stringify(about, null, 2)},
  contact: ${JSON.stringify(contact, null, 2)},
  featuredCert: ${JSON.stringify(fc, null, 2)}
};

document.addEventListener('DOMContentLoaded', () => {
    if (typeof AOS !== 'undefined') {
        AOS.init({ duration: 700, easing: 'ease-out-cubic', once: true, offset: 40 });
    }
    applyHero();
    applyAbout();
    applyContact();
    initNav();
    initCursor();
    initCounters();
    initRings();
    initFolderTabs();
    loadExperience();
    loadSkills();
    loadTechStack();
    loadLanguages();
    loadCertifications();
    initSkillBars();
    applyFeaturedCert();
});

function applyHero() {
    const h = PORTFOLIO.hero;
    const setTxt = (sel, val) => { const el = document.querySelector(sel); if(el) el.textContent = val; };
    setTxt('.id-name', h.name);
    setTxt('.id-title', h.title);
    const loc = document.querySelector('.id-location span'); if(loc) loc.textContent = h.location;
    const avail = document.querySelector('.id-availability span:last-child'); if(avail) avail.textContent = h.avail;
    const hl = document.querySelector('.hero-headline');
    if(hl) hl.innerHTML = h.line1 + '<br><em>' + h.line2 + '</em><br>' + h.line3;
    setTxt('.hero-brief', h.brief);
    const counts = document.querySelectorAll('[data-count]');
    const vals = [h.years, h.tickets, h.sla];
    counts.forEach((c,i) => { if(vals[i] !== undefined) { c.setAttribute('data-count', vals[i]); c.textContent = '0'; } });
    const resume = document.querySelectorAll('a[href*="drive.google.com"]');
    resume.forEach(a => { if(a.closest('.nav-resume-btn, .mob-cta, .hero-ctas')) a.href = h.resume; });
    const logoSub = document.querySelector('.logo-sub'); if(logoSub) logoSub.textContent = h.title;
    const navTitle = document.querySelector('title'); if(navTitle) navTitle.textContent = h.name + ' | ' + h.title;
}

function applyAbout() {
    const a = PORTFOLIO.about;
    const lead = document.querySelector('.bio-lead'); if(lead) lead.innerHTML = a.lead;
    const bodies = document.querySelectorAll('.bio-body');
    if(bodies[0]) bodies[0].innerHTML = a.body1;
    if(bodies[1]) bodies[1].innerHTML = a.body2;
    const metrics = document.querySelectorAll('.pm-label strong');
    if(metrics[0]) metrics[0].textContent = a.systems;
    if(metrics[1]) metrics[1].textContent = a.networks;
    const ring = document.querySelector('.ring-val'); if(ring) ring.textContent = a.sla;
    const ringFg = document.querySelector('.ring-fg'); if(ringFg) ringFg.setAttribute('data-percent', a.sla);
    const achieves = document.querySelector('.bio-achieves');
    if(achieves && a.achieves) {
        achieves.innerHTML = a.achieves.map(ac => \`
            <div class="achieve-item">
                <span class="achieve-icon"><i class="fas \${ac.icon}"></i></span>
                <div><strong>\${ac.title}</strong><span>\${ac.desc}</span></div>
            </div>\`).join('');
    }
}

function applyContact() {
    const c = PORTFOLIO.contact;
    const phoneEl = document.querySelector('a[href^="tel"]');
    if(phoneEl) { phoneEl.href = 'tel:' + c.phone.replace(/\\s/g,''); phoneEl.textContent = c.phone; }
    const locationEls = document.querySelectorAll('.contact-card p');
    locationEls.forEach(el => { if(el.closest('.contact-card') && !el.closest('h4')) el.textContent = c.location; });
    const webBtn = document.querySelector('.exec-social-btn[href*="sajidmk"]');
    if(webBtn) { webBtn.href = c.web; webBtn.innerHTML = '<i class="fas fa-globe"></i> ' + c.web.replace('https://',''); }
    const liBtn = document.querySelector('.exec-social-btn[href*="linkedin"]');
    if(liBtn) liBtn.href = c.linkedin;
    const igBtn = document.querySelector('.exec-social-btn[href*="instagram"]');
    if(igBtn) igBtn.href = c.instagram;
}

function applyFeaturedCert() {
    const fc = PORTFOLIO.featuredCert;
    const t = document.querySelector('.cwf-title'); if(t) t.innerHTML = fc.title + '<br><span>' + fc.subtitle + '</span>';
    const iss = document.querySelector('.cwf-issuer'); if(iss) iss.textContent = fc.issuer;
    const dt = document.querySelector('.cwf-date'); if(dt) dt.textContent = 'Issued: ' + fc.date;
    const code = document.querySelector('.cwf-code'); if(code) code.textContent = 'Code: ' + fc.code;
    const desc = document.querySelector('.cwf-desc'); if(desc) desc.textContent = fc.desc;
    const link = document.querySelector('.featured-cert-frame a'); if(link) link.href = fc.url;
}

function initNav() {
    const nav = document.getElementById('topNav');
    const hamburger = document.getElementById('hamburger');
    const drawer = document.getElementById('mobileDrawer');
    const navLinks = document.querySelectorAll('.nav-link');
    window.addEventListener('scroll', () => {
        nav?.classList.toggle('scrolled', window.scrollY > 60);
        const sections = document.querySelectorAll('section[id]');
        let current = '';
        sections.forEach(s => { if (window.scrollY >= s.offsetTop - 160) current = s.id; });
        navLinks.forEach(l => { l.classList.remove('active'); if (l.getAttribute('href') === \`#\${current}\`) l.classList.add('active'); });
    });
    hamburger?.addEventListener('click', () => { hamburger.classList.toggle('open'); drawer?.classList.toggle('open'); });
    document.querySelectorAll('.mob-link').forEach(l => { l.addEventListener('click', () => { hamburger?.classList.remove('open'); drawer?.classList.remove('open'); }); });
    document.addEventListener('click', (e) => { if (drawer?.classList.contains('open') && !drawer.contains(e.target) && !hamburger?.contains(e.target)) { hamburger?.classList.remove('open'); drawer?.classList.remove('open'); } });
    document.querySelectorAll('a[href^="#"]').forEach(a => { a.addEventListener('click', function(e) { const href = this.getAttribute('href'); if (href === '#') return; e.preventDefault(); const target = document.querySelector(href); if (target) window.scrollTo({ top: target.offsetTop - 80, behavior: 'smooth' }); }); });
}

function initCursor() {
    const dot = document.getElementById('cursorDot');
    const ring = document.getElementById('cursorRing');
    if (!dot || !ring || window.innerWidth < 1024) return;
    document.addEventListener('mousemove', (e) => { dot.style.left = e.clientX + 'px'; dot.style.top = e.clientY + 'px'; setTimeout(() => { ring.style.left = e.clientX + 'px'; ring.style.top = e.clientY + 'px'; }, 70); });
    document.querySelectorAll('a, button, .skill-card, .achieve-item, .exp-card').forEach(el => { el.addEventListener('mouseenter', () => { ring.style.width = '44px'; ring.style.height = '44px'; ring.style.opacity = '.4'; }); el.addEventListener('mouseleave', () => { ring.style.width = '28px'; ring.style.height = '28px'; ring.style.opacity = '.6'; }); });
}

function initCounters() {
    document.querySelectorAll('[data-count]').forEach(el => {
        const io = new IntersectionObserver(entries => { entries.forEach(e => { if (e.isIntersecting) { animateCount(el); io.unobserve(el); } }); }, { threshold: 0.5 });
        io.observe(el);
    });
}
function animateCount(el) {
    const target = +el.getAttribute('data-count');
    const duration = 1400; const start = performance.now();
    const step = (now) => { const t = Math.min((now - start) / duration, 1); el.textContent = Math.ceil(t * target); if (t < 1) requestAnimationFrame(step); else el.textContent = target; };
    requestAnimationFrame(step);
}

function initRings() {
    document.querySelectorAll('.ring-fg').forEach(ring => {
        const io = new IntersectionObserver(entries => { entries.forEach(e => { if (e.isIntersecting) { const pct = parseInt(ring.getAttribute('data-percent')); const circ = 2 * Math.PI * 50; ring.style.strokeDasharray = circ; ring.style.strokeDashoffset = circ; setTimeout(() => { ring.style.strokeDashoffset = circ - (pct / 100) * circ; }, 300); io.unobserve(ring); } }); }, { threshold: 0.4 });
        io.observe(ring);
    });
}

function initFolderTabs() {
    const tabs = document.querySelectorAll('.ftab');
    tabs.forEach(tab => { tab.addEventListener('click', () => { const paneId = tab.getAttribute('data-pane'); tabs.forEach(t => t.classList.remove('active')); tab.classList.add('active'); document.querySelectorAll('.folder-pane').forEach(p => p.classList.remove('active')); document.getElementById(paneId)?.classList.add('active'); }); });
}

function initSkillBars() {
    const bento = document.getElementById('skillsBento');
    if (!bento) return;
    const io = new IntersectionObserver(entries => { entries.forEach(e => { if (e.isIntersecting) { e.target.querySelectorAll('.sk-bar-fill').forEach(bar => { setTimeout(() => { bar.style.width = bar.getAttribute('data-width'); }, 200); }); io.unobserve(e.target); } }); }, { threshold: 0.2 });
    io.observe(bento);
}

const experienceData = [
    ${expStr}
];

function loadExperience() {
    const timeline = document.getElementById('expTimeline');
    if (!timeline) return;
    experienceData.forEach((exp, i) => {
        const item = document.createElement('div');
        item.className = 'exp-item';
        item.setAttribute('data-aos', 'fade-up');
        item.setAttribute('data-aos-delay', i * 80);
        const lettersHTML = (exp.letters || []).map(l => \`<a href="\${l.url}" target="_blank" rel="noopener noreferrer" class="exp-btn"><i class="fas fa-file-contract"></i>\${l.text}</a>\`).join('');
        item.innerHTML = \`<div class="exp-card"><div class="exp-header"><div class="exp-title-row"><h3 class="exp-title">\${exp.title}</h3>\${exp.type ? \`<span class="exp-type-badge">\${exp.type}</span>\` : ''}</div><div class="exp-meta"><span class="exp-date"><i class="fas fa-calendar-alt"></i> \${exp.date}</span><span class="exp-company-name">\${exp.company}</span></div></div><ul class="exp-list">\${exp.responsibilities.map(r => \`<li>\${r}</li>\`).join('')}</ul><div class="exp-actions">\${lettersHTML}</div></div>\`;
        timeline.appendChild(item);
    });
}

const skillsData = [
${skillsStr}
];

function loadSkills() {
    const bento = document.getElementById('skillsBento');
    if (!bento) return;
    skillsData.forEach((s, i) => {
        const card = document.createElement('div');
        card.className = 'skill-card';
        card.setAttribute('data-aos', 'fade-up');
        card.setAttribute('data-aos-delay', i * 60);
        card.innerHTML = \`<div class="sk-icon"><i class="fas \${s.icon}"></i></div><div class="sk-name">\${s.name}</div><div class="sk-cat">\${s.cat}</div><div class="sk-bar-track"><div class="sk-bar-fill" data-width="\${s.level}%"></div></div><div class="sk-pct">\${s.level}%</div>\`;
        bento.appendChild(card);
    });
}

const techStack = [
${techStr}
];

function loadTechStack() {
    const container = document.getElementById('techPills');
    if (!container) return;
    techStack.forEach((t, i) => { const pill = document.createElement('span'); pill.className = 'tech-pill'; pill.textContent = t; pill.setAttribute('data-aos','zoom-in'); pill.setAttribute('data-aos-delay', i * 25); container.appendChild(pill); });
}

const languages = [
${langsStr}
];

function loadLanguages() {
    const grid = document.getElementById('langGrid');
    if (!grid) return;
    languages.forEach(l => { const card = document.createElement('div'); card.className = 'lang-card'; card.innerHTML = \`<span class="lang-name">\${l.name}</span><span class="lang-level">\${l.level}</span>\`; grid.appendChild(card); });
}

const additionalCerts = [
${certsStr}
];

function loadCertifications() {
    const wall = document.getElementById('certsWall');
    if (!wall) return;
    additionalCerts.forEach((cert, i) => {
        const frame = document.createElement('div');
        frame.className = 'cw-frame';
        frame.setAttribute('data-aos', 'fade-up');
        frame.setAttribute('data-aos-delay', i * 80);
        frame.innerHTML = \`<div class="cw-frame-inner"><div class="cw-icon"><i class="fas \${cert.icon}"></i></div><div class="cw-title">\${cert.title}</div><div class="cw-desc">\${cert.desc}</div>\${cert.url ? \`<a href="\${cert.url}" target="_blank" rel="noopener noreferrer" class="btn btn-gold btn-sm"><i class="fas fa-eye"></i> View Certificate</a>\` : ''}</div>\`;
        wall.appendChild(frame);
    });
}

console.log('%c⚜ Sajid Mehmood — IT Support Engineer Portfolio', 'font-size:16px;font-weight:bold;color:#C5A059;background:#2D3436;padding:10px 22px;border-radius:4px;');
`;
}

function downloadScript() {
  const script = buildScript();
  const blob = new Blob([script], { type: 'text/javascript' });
  const a = document.createElement('a');
  a.href = URL.createObjectURL(blob);
  a.download = 'script.js';
  a.click();
}

// ════════════════════════════════════════
// HELPERS
// ════════════════════════════════════════
function es(str) {
  return (str || '').replace(/\\/g,'\\\\').replace(/'/g,"\\'").replace(/\n/g,'\\n');
}
function esc(str) {
  return (str || '').replace(/"/g,'&quot;').replace(/</g,'&lt;').replace(/>/g,'&gt;');
}
function v(id) {
  const el = document.getElementById(id);
  return el ? el.value.trim() : '';
}
</script>
</body>
</html>